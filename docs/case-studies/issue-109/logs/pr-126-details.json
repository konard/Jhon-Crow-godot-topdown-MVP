{"author":{"id":"MDQ6VXNlcjE0MzE5MDQ=","is_bot":false,"login":"konard","name":"Konstantin Diachenko"},"body":"## Summary\n\nImplements directional screen shake when the player fires weapons, as requested in #109.\n\n### Features\n- **Directional Shake**: Screen shakes in the direction opposite to shooting (recoil effect)\n- **Per-Weapon Configuration**: Each weapon can have custom shake parameters via WeaponData\n- **Fire Rate-Based Intensity**: Lower fire rate = larger shake per shot (accumulates faster for rapid fire)\n- **Spread-Based Recovery**: Recovery speed interpolates based on current spread (faster at max spread)\n- **Minimum Recovery Time**: 50ms minimum enforced as per specification\n- **Shake Accumulation**: Multiple shots accumulate shake, clamped to maximum offset\n\n### Implementation Details\n\n#### New Files\n- `scripts/autoload/screen_shake_manager.gd` - Centralized shake manager autoload\n- `tests/unit/test_screen_shake_manager.gd` - Unit tests for shake calculations\n- `docs/case-studies/issue-109/README.md` - Case study documentation\n\n#### Modified Files\n- `Scripts/Data/WeaponData.cs` - Added ScreenShakeIntensity, ScreenShakeMinRecoveryTime, ScreenShakeMaxRecoveryTime\n- `Scripts/Weapons/AssaultRifle.cs` - Integrated screen shake on firing (automatic, burst, and chamber bullet)\n- `scripts/characters/player.gd` - Integrated screen shake for GDScript version\n- `resources/weapons/AssaultRifleData.tres` - Added default shake values\n- `project.godot` - Registered ScreenShakeManager autoload\n\n### Shake Formula\n\n```\nshake_intensity = base_intensity / fire_rate * 10\nshake_direction = -shooting_direction (opposite)\nrecovery_time = lerp(min_recovery, max_recovery, spread_ratio)\nrecovery_time = max(recovery_time, 0.05)  # 50ms minimum\n```\n\n### Default Values (Assault Rifle)\n- Screen Shake Intensity: 5.0 pixels\n- Min Recovery Time: 0.25 seconds (at min spread)\n- Max Recovery Time: 0.05 seconds (at max spread)\n\n## Test Plan\n- [ ] Verify screen shakes when firing in GDScript player\n- [ ] Verify screen shakes when firing C# AssaultRifle\n- [ ] Confirm shake direction is opposite to shooting direction\n- [ ] Test that rapid fire accumulates shake\n- [ ] Verify recovery is faster at higher spread\n- [ ] Run unit tests: `gut -gtest=res://tests/unit/test_screen_shake_manager.gd`\n\n## References\n- [Screen Shake :: Godot 4 Recipes](https://kidscancode.org/godot_recipes/4.x/2d/screen_shake/index.html)\n- [Camera Shake GDC Talk](https://www.youtube.com/watch?v=tu-Qe66AvtY)\n\nFixes #109\n\n---\n*Generated with [Claude Code](https://claude.com/claude-code)*","comments":[{"id":"IC_kwDOQ35BQ87gbDgG","author":{"login":"konard"},"authorAssociation":"CONTRIBUTOR","body":"## ü§ñ Solution Draft Log\nThis log file contains the complete execution trace of the AI solution draft process.\n\nüí∞ **Cost estimation:**\n- Public pricing estimate: $4.819906 USD\n- Calculated by Anthropic: $3.232112 USD\n- Difference: $-1.587794 (-32.94%)\nüìé **Log file uploaded as Gist** (871KB)\nüîó [View complete solution draft log](https://gist.githubusercontent.com/konard/258e68e0ce128ad0c3016ec2d2bbde83/raw/0212000cfe466f5e5680a25ee84c18fbac62af59/solution-draft-log-pr-1768735405032.txt)\n---\n*Now working session is ended, feel free to review and add any feedback on the solution draft.*","createdAt":"2026-01-18T11:23:30Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/Jhon-Crow/godot-topdown-MVP/pull/126#issuecomment-3765188614","viewerDidAuthor":true},{"id":"IC_kwDOQ35BQ87gbIm9","author":{"login":"Jhon-Crow"},"authorAssociation":"OWNER","body":"–≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç, —Ä–µ—à–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç —Å–æ—Ö—Ä–∞–Ω—è—è –≤–µ—Å—å –Ω–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª (–∏–∑ –æ–±–æ–∏—Ö –≤–µ—Ç–æ–∫).\r\n\r\nPlease download all logs and data related about the issue to this repository, make sure we compile that data to `./docs/case-studies/issue-{id}` folder, and use it to do deep case study analysis (also make sure to search online for additional facts and data), in which we will reconstruct timeline/sequence of events, find root causes of the problem, and propose possible solutions.\r\n","createdAt":"2026-01-18T11:50:50Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/Jhon-Crow/godot-topdown-MVP/pull/126#issuecomment-3765209533","viewerDidAuthor":false},{"id":"IC_kwDOQ35BQ87gbKPZ","author":{"login":"konard"},"authorAssociation":"CONTRIBUTOR","body":"ü§ñ **AI Work Session Started**\n\nStarting automated work session at 2026-01-18T11:59:41.595Z\n\nThe PR has been converted to draft mode while work is in progress.\n\n_This comment marks the beginning of an AI work session. Please wait working session to finish, and provide your feedback._","createdAt":"2026-01-18T11:59:43Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/Jhon-Crow/godot-topdown-MVP/pull/126#issuecomment-3765216217","viewerDidAuthor":true}],"commits":[{"authoredDate":"2026-01-18T11:14:45Z","authors":[{"email":"drakonard@gmail.com","id":"MDQ6VXNlcjE0MzE5MDQ=","login":"konard","name":"konard"}],"committedDate":"2026-01-18T11:14:45Z","messageBody":"Adding CLAUDE.md with task information for AI processing.\nThis file will be removed when the task is complete.\n\nIssue: https://github.com/Jhon-Crow/godot-topdown-MVP/issues/109","messageHeadline":"Initial commit with task details","oid":"d20b742828d05093cbca1c1cf873bff1abaed7c4"},{"authoredDate":"2026-01-18T11:21:24Z","authors":[{"email":"drakonard@gmail.com","id":"MDQ6VXNlcjE0MzE5MDQ=","login":"konard","name":"konard"},{"email":"noreply@anthropic.com","id":"MDQ6VXNlcjgxODQ3","login":"claude","name":"Claude Opus 4.5"}],"committedDate":"2026-01-18T11:21:24Z","messageBody":"Implements directional screen shake that triggers when player fires weapons.\nThe shake direction is opposite to shooting direction (recoil effect).\n\nFeatures:\n- ScreenShakeManager autoload for centralized camera shake control\n- Shake intensity varies by fire rate (lower rate = larger shake per shot)\n- Recovery speed varies by spread (faster recovery at max spread)\n- Minimum 50ms recovery time enforced per specification\n- Shake accumulates with consecutive shots\n- Maximum shake offset clamped to prevent extreme values\n\nChanges:\n- Add ScreenShakeIntensity, ScreenShakeMinRecoveryTime, ScreenShakeMaxRecoveryTime\n  to WeaponData.cs for per-weapon configuration\n- Update AssaultRifleData.tres with shake parameters\n- Integrate screen shake in GDScript player.gd\n- Integrate screen shake in C# AssaultRifle.cs\n- Add unit tests for shake calculations\n\nFixes #109\n\nCo-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>","messageHeadline":"Add weapon-specific screen shake on firing","oid":"b2750f66dc0acdb474de849c5c2ba916108e5d96"},{"authoredDate":"2026-01-18T11:23:21Z","authors":[{"email":"drakonard@gmail.com","id":"MDQ6VXNlcjE0MzE5MDQ=","login":"konard","name":"konard"}],"committedDate":"2026-01-18T11:23:21Z","messageBody":"This reverts commit d20b742828d05093cbca1c1cf873bff1abaed7c4.","messageHeadline":"Revert \"Initial commit with task details\"","oid":"51c915469bb41d3c733404a14eb46747a76b613b"}],"createdAt":"2026-01-18T11:14:52Z","files":[{"path":"Scripts/Data/WeaponData.cs","additions":24,"deletions":0},{"path":"Scripts/Weapons/AssaultRifle.cs","additions":98,"deletions":1},{"path":"docs/case-studies/issue-109/README.md","additions":100,"deletions":0},{"path":"project.godot","additions":1,"deletions":0},{"path":"resources/weapons/AssaultRifleData.tres","additions":3,"deletions":0},{"path":"scripts/autoload/screen_shake_manager.gd","additions":151,"deletions":0},{"path":"scripts/characters/player.gd","additions":52,"deletions":0},{"path":"tests/unit/test_screen_shake_manager.gd","additions":178,"deletions":0}],"reviews":[],"state":"OPEN","title":"Add weapon-specific screen shake on firing"}
